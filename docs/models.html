<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ANLY560 - Phil Cork - ARMA/ARIMA/SARIMA Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">ARMA/ARIMA/SARIMA Models</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ANLY560 - Phil Cork</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about-author.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-sources.html" class="sidebar-item-text sidebar-link">Data Sources</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualization.html" class="sidebar-item-text sidebar-link">Data Visualization</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exploratory-data-analysis.html" class="sidebar-item-text sidebar-link">Exploratory Data Analysis</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.html" class="sidebar-item-text sidebar-link active">ARMA/ARIMA/SARIMA Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arimax.html" class="sidebar-item-text sidebar-link">ARIMAX/SARIMAX/VAR Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spectral-analysis.html" class="sidebar-item-text sidebar-link">Spectral Analysis and Filtering</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./financial-ts-models.html" class="sidebar-item-text sidebar-link">Financial Time Series Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deep-learning.html" class="sidebar-item-text sidebar-link">Deep Learning for TS</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusions.html" class="sidebar-item-text sidebar-link">Conclusions</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">ARMA/ARIMA/SARIMA Models</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<p>Having established the rise and fall of Hasbro’s stock price over recent years, our attention now turns to how well the stock’s performance can be modeled and forecast based on only its past values. We first re-evaluate the stationarity of the data before building and evaluating potential models.</p>
<p><br>
</p>
<section id="revisiting-stationarity1" class="level3">
<h3 class="anchored" data-anchor-id="revisiting-stationarity1">Revisiting Stationarity<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></h3>
<p>From the analysis conducted during the <a href="./exploratory-data-analysis.html">exploratory</a> stage, Hasbro’s stock data has been first-order differenced into a weakly stationary dataset. To confirm this transformation, we consider the ACF plot and Augmented Dickey-Fuller Test results for the differenced time series.</p>
<p><br>
</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="models_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
<p><br>
</p>
<table class="table">
<thead>
<tr class="header">
<th><strong>Dickey-Fuller</strong></th>
<th><strong>-9.55</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Lag order</td>
<td>10</td>
</tr>
<tr class="even">
<td><strong>p-value</strong></td>
<td><strong>&gt;0.01</strong></td>
</tr>
<tr class="odd">
<td>Alternative Hypothesis</td>
<td>stationary</td>
</tr>
</tbody>
</table>
<p><br>
</p>
<p>With a p-value that is statistically significant with a 99% confidence interval, we can proceed under the assumption that the first order difference data is now at least weakly stationary.</p>
<p><br>
</p>
</section>
<section id="determining-model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="determining-model-parameters">Determining Model Parameters</h3>
<p>To implement an ARIMA model for predicting time series values, we’ll need to determine how many lags of the stock’s price and how many of the lagged errors to include in the model. These features will reduce the correlation inherent when working with time series data, where each data point is related to or even determined by the former data point. Our stock price certainly fits this definition, where one day’s closing price is often very informative of the next day’s closing price. This reality is particularly true for Hasbro’s price which, while volatile at times, does not move in such drastic price changes as some higher profile stocks.</p>
<p>When evaluating how many past values we should take into account, we consider the PACF plot of the original dataset and use the lags that are statistically significant as potential parameters for the value of p in the ARIMA model.</p>
<p><br>
</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="models_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br>
</p>
<p>From the PACF plot of the first-order difference of Hasbro’s stock prices, we see that none of the lags are statistically significant. The first lag seems to be the closest within the first handful of results and thus will be considered in the model, along with 0.</p>
<p>When looking at how many instances of past forecast errors to include in the model, we use the ACF plot and consider the points that are statistically significant.</p>
<p><br>
</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="models_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br>
</p>
<p>In the ACF plot of the first-order difference data, we see the first lag is the only statistically significant option, but that the second lag is perhaps worth considering in addition to 0.</p>
<p><br>
</p>
</section>
<section id="arima-model-tuning" class="level3">
<h3 class="anchored" data-anchor-id="arima-model-tuning">ARIMA Model Tuning</h3>
<p>With initial parameters selected, we begin building models for each combination of parameters. We’ll then use a number of diagnostic values to determine which model to use in forecasting.</p>
<p><br>
</p>
<div class="cell">

</div>
<table class="table">
<thead>
<tr class="header">
<th>p</th>
<th>d</th>
<th>q</th>
<th>AIC</th>
<th>BIC</th>
<th>AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1</td>
<td>0</td>
<td>4058.619</td>
<td><em>4063.534</em></td>
<td>4058.623</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td>1</td>
<td>4058.285</td>
<td>4068.114</td>
<td>4058.297</td>
</tr>
<tr class="odd">
<td>0</td>
<td>1</td>
<td>2</td>
<td>4060.160</td>
<td>4074.905</td>
<td>4060.184</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>0</td>
<td><em>4058.241</em></td>
<td>4068.070</td>
<td>4058.253</td>
</tr>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>1</td>
<td>4060.197</td>
<td>4074.941</td>
<td>4060.221</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>2</td>
<td>4062.173</td>
<td>4081.832</td>
<td>4062.213</td>
</tr>
</tbody>
</table>
<p><br>
</p>
<p>From considering the AIC and BIC values, two model evaluation measures we seek to minimize, it seems the simplest models perform the best. The model that considers only the differenced data (<code>ARIMA(0,1,0)</code>), essentially making it a random walk model, provides the minimum BIC, while the model that considers the differenced data with a single lag term (<code>ARIMA(1,1,0)</code>) provides the minimum AIC with a slightly higher BIC. Given that both of these models make a logical sense based on the use of financial data, we will proceed in comparing them with further diagnostic analysis.</p>
<p><br>
</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="models_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br>
</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="models_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br>
</p>
<p>The diagnostics of the two models are largely the same, as to be expected with their similar AIC and BIC scores. In both, the standardized residuals are largely static and within the same range, with the same dramatic outliers that represent volatile movements in Hasbro’s stock price, such as the impact of COVID-19 and other events. The ACF of the residuals is entirely insignificant. The Q-Q plot of the residuals shows a strong linear patterns with a few extreme outliers at the edges, again representative of the days where large price swings occurred. The p-values of the Ljung-Box statistics, however, are where the models begin to differ, with the second model’s p-values being generally a bit higher, which is desirable in this case. Even so, the first model remains preferable for being the simpler of the two models, since it suggests that just by differencing the data to the first order, we have sufficiently removed the autocorrelation in the time series and thus it may not be necessary to include a lag value at all.</p>
<p><br>
</p>
</section>
<section id="auto-arima" class="level3">
<h3 class="anchored" data-anchor-id="auto-arima">Auto-Arima</h3>
<div class="cell">

</div>
<p><br>
</p>
<table class="table">
<thead>
<tr class="header">
<th>Auto-ARIMA Results</th>
<th>AIC</th>
<th>BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ARIMA(0,1,0)</td>
<td>4058.62</td>
<td>4063.53</td>
</tr>
</tbody>
</table>
<p><br>
</p>
<p>Without any further parameters provided, the <code>auto.arima</code> function suggests that the random walk <code>ARIMA(0,1,0)</code> model is the best fit and returns the same AIC and BIC as the manually tuned models. Though this process does not always optimize a model perfectly, it is a helpful confirmation of our process in this case and affirms the decision to proceed with the random walk model.</p>
<p>The model of the equation is thus simply:</p>
<p><br>
</p>
<p><span class="math display">\[
𝑋_{𝑖+1} =𝑋_𝑖+ \epsilon_i
\]</span></p>
</section>
<section id="forecasting" class="level3">
<h3 class="anchored" data-anchor-id="forecasting">Forecasting</h3>
<div class="cell">

</div>
<p><br>
</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="models_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br>
</p>
<p>The shortcoming of the simplicity of the model, then, becomes more apparently in the forecasting process, where each prediction appears to simply be sideways movement of the most recent value. The 80% and 95% confidence intervals are often quite broad, suggesting that within the next month, the stock’s price could move somewhere between $55 and $75, a range that’s roughly one-fourth to one-third of the stock’s price over the course of 2022.</p>
<p><br>
</p>
</section>
<section id="benchmark-methods" class="level3">
<h3 class="anchored" data-anchor-id="benchmark-methods">Benchmark Methods</h3>
<p>With this rather broad estimation in mind, it is worth considering whether the model can out perform benchmark measures by comparing how well it performs on predicting test data using training data versus how well the mean or naive estimate methods perform in the same context.</p>
<p><br>
</p>
<div class="cell">

</div>
<p><br>
</p>
<div class="cell">

</div>
<table class="table">
<colgroup>
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>ME</th>
<th>RMSE</th>
<th>MAE</th>
<th>MPE</th>
<th>MAPE</th>
<th>MASE</th>
<th>ACF1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(0,1,0) Model</td>
<td>-0.00676</td>
<td>1.8207</td>
<td>1.202</td>
<td>-0.039</td>
<td>1.498</td>
<td>0.999</td>
<td>0.059</td>
</tr>
<tr class="even">
<td>Mean</td>
<td>-3.3914</td>
<td>11.15</td>
<td>8.97</td>
<td>-2.03</td>
<td>11.41</td>
<td>7.49</td>
<td>0.98</td>
</tr>
<tr class="odd">
<td>Naive</td>
<td>-0.0684</td>
<td>1.8217</td>
<td>1.203</td>
<td>-0.0391</td>
<td>1.499</td>
<td>1</td>
<td>0.059</td>
</tr>
</tbody>
</table>
<p><br>
</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="models_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br>
</p>
<p>Both the evaluation metrics and plotted forecasting values make it clear that while the model outperforms the mean benchmark (which is inflated by higher values in previous years), it performs almost identically to the naive method benchmark. Given the simplicity of the model, this is not particularly surprising. Without a seasonal component to take into account, the weakly stationary data has a consistent mean and variance, which would in turn lead to a set of predictions that do not vary over the predicted time frame.</p>
<p><br>
</p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>We first reestablished the stationarity of the first-order difference of Hasbro’s stock price data. We then used ACF and PACF plots to choose a subset of model parameters. We built a model that used only the differenced data, as it provided the best performance and most intuitive explanation of the data. We then used the model to forecast future stock prices and compared its predictions to benchmark methods. Ultimately, the model proved to perform better than the simple mean method, but only just as well as a naive benchmark method.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://github.com/phil-cork/TimeSeries_Website/blob/main/_website_source/models.qmd">Code for all models and data visualization</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>